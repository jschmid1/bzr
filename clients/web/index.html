<html>
<head>
    <head>
        <title>Hello jQuery</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
</head>

  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <style>
  #draggable { width: 150px; height: 150px; padding: 0.5em; }
  </style>
<body>  

<script type="text/javascript">
        function get_all_basegoods() {
           return  $.ajax({ 
               type: "GET",
               dataType: "json",
               contentType: "application/json; charset=utf-8",
               url: "http://localhost:5000/basegoods",
           });
        }

        function sell_basegood(id) {
           return  $.ajax({ 
               type: "PUT",
               dataType: "json",
               data: "{ \"action\": \"sell\"}",
               contentType: "application/json; charset=utf-8",
               url: "http://localhost:5000/basegoods/"+id,
           });
        }
        function buy_basegood(id) {
           return  $.ajax({ 
               type: "PUT",
               dataType: "json",
               data: "{ \"action\": \"buy\"}",
               contentType: "application/json; charset=utf-8",
               url: "http://localhost:5000/basegoods/"+id,
           });
        }

function handle_selling(id) { 
      $(function(){
          var promise = sell_basegood(id);
          promise.success(function(output) {
              console.log(output);
              });
          promise.error(function(output) {
              console.log("error:" + output);
              });
      });
}

function handle_buying(id) { 
      $(function(){
          var promise = buy_basegood(id);
          promise.success(function(output) {
              console.log(output);
              });
          promise.error(function(output) {
              console.log("error:" + output);
              });
      });
}

$(document).ready(function(){
        $("#btn").click(function() {
            handle_selling(1);
            alert('sold');
            });
});
$(document).ready(function(){
        $("#btn2").click(function() {
            handle_buying(1);
            alert('bought');
            });
});


document.body.onload = addElement;

function addElement () { 
      $(function(){
          var promise = get_all_basegoods();
          promise.success(function(output) {
              $.each( output.basegoods,function(index, item) {
                      console.log(item);
                      var $div = $("<div>", {id: item.id, "class": "basegood"});
                      $($div).append("<p>"+item.name + "</p>");
                      $($div).append("<p>"+item.price + "</p>");
                      $('.container').append($div);
                      $($div).draggable();
                  });
              });
      });
}
</script>

<div class="container">

</div>

<button id="btn" type="button">sell!</button> 
<button id="btn2" type="button">buy!</button> 

</body>
</html>
